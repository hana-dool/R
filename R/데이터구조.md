데이터 구조및 변환
================

# 데이터 구조

R 에는 많은 데이터 구조가 있다. <br> 각각에 맞는 데이터 유형을 알아두어야 나중에 사용할 수 있을것이다.

## Scala

구성인자가 하나인 벡터

``` r
c(1)
```

    ## [1] 1

## Vector

vector 는 구성인자가 1개 이상인 1차원 구조이다. <br> vector 안의 구성인자들은 동질적이다. 즉 벡터의 모든
원소들은 같은 자료형을 가져야 한다.

``` r
c(1,2,3) # 이렇게 수행되면 동일한 숫자의 자료형을 가지게 된다.
```

    ## [1] 1 2 3

``` r
c(1,'tom',3) # 이렇게 수행되면 string(문자) 의 동일한 자료형을 가지게 된다.
```

    ## [1] "1"   "tom" "3"

``` r
x <- c('a','b','c')
names(x) <- c('first','second','third') # 이와 같이 벡터에 이름을 부여할 수 있다.
x['first'] # 그에 따라 이름을 가진 vector 가 만들어진다.
```

    ## first 
    ##   "a"

``` r
names(x) # vector 의 label 은 names 를 통해서 추출할 수 있다.
```

    ## [1] "first"  "second" "third"

## list

생각보다 자주 사용되지는 않는다. <br> list 자료형을 사용할경우 서로 다른 타입들의 변수를 가져다가 붙일 수 있다.
<br> 그리고 서로 다른 길이, 서로 다른 차원으로 구성될 수 있다. <br>

``` r
school <- list(name = c('han','kim','hyo'),
              address = c('seoul','USA'),
              age = c(24))
# list 를 입력할때에는 위 처럼 = 를 사용해야 한다.
school # 위와 같이 class 라는 list 안에 또 다른 list 형성 가능.
```

    ## $name
    ## [1] "han" "kim" "hyo"
    ## 
    ## $address
    ## [1] "seoul" "USA"  
    ## 
    ## $age
    ## [1] 24

## list 의 접근

**$로 접근하는 list**

``` r
school$name # schoole 에서 name 의 '구성성분 추출'
```

    ## [1] "han" "kim" "hyo"

**\[\[\]\] 로 접근하는 list 구성성분 추출**

``` r
school[['name']]  # 'name' 의 구성성분 추출
```

    ## [1] "han" "kim" "hyo"

``` r
school[[1]] # name(첫번쨰) 의 구성성분 추출
```

    ## [1] "han" "kim" "hyo"

**\[\] 로 접근하는 ’ sub list’ 추출**

``` r
school['name']
```

    ## $name
    ## [1] "han" "kim" "hyo"

``` r
school[1]
```

    ## $name
    ## [1] "han" "kim" "hyo"

**\[\[\]\] 와 \[\] 의 차이** <br> \[\[\]\] : sublist 의 구성성분을 추출한다.<br> \[\]
: sublist 를 추출한다. 즉 list를 얻음<br>

``` r
class(school[1]) # sublist 추출 
```

    ## [1] "list"

``` r
class(school[[1]]) # list 에서 1번째 sublist 의 구성성분 추출
```

    ## [1] "character"

## array

동일한 유형의 데이터가 2차원 이상으로 구성

``` r
array1 = array(1:24,c(2,3,4)) # 2*3*4 array
array1
```

    ## , , 1
    ## 
    ##      [,1] [,2] [,3]
    ## [1,]    1    3    5
    ## [2,]    2    4    6
    ## 
    ## , , 2
    ## 
    ##      [,1] [,2] [,3]
    ## [1,]    7    9   11
    ## [2,]    8   10   12
    ## 
    ## , , 3
    ## 
    ##      [,1] [,2] [,3]
    ## [1,]   13   15   17
    ## [2,]   14   16   18
    ## 
    ## , , 4
    ## 
    ##      [,1] [,2] [,3]
    ## [1,]   19   21   23
    ## [2,]   20   22   24

``` r
array1[1,2,3]  # 1row,2col,3번쨰 행렬 추출
```

    ## [1] 15

## Matrix(행렬)

동일한 유형의 2차원 데이터 <br> 행렬은 모든 element 의 값들이 ‘같은’ 형태여야 합니다. <br> 즉
1,2,3,‘no’ 의 4개 element 로 구성되어있는 vector 를 matrix 로 변환시
‘1’,‘2’,‘3’,‘no’ 로 강제형변환이 됩니다. <br>

``` r
matrix(1:12,nrow=3)
```

    ##      [,1] [,2] [,3] [,4]
    ## [1,]    1    4    7   10
    ## [2,]    2    5    8   11
    ## [3,]    3    6    9   12

``` r
# nrow : row 의 수
# ncol : col 의 수
```

``` r
matrix(1:12,nrow=3,
       dimnames = list(c('a','b','c'),c('1','2','3','4')))
```

    ##   1 2 3  4
    ## a 1 4 7 10
    ## b 2 5 8 11
    ## c 3 6 9 12

``` r
# dimnames : 행과 열에 이름을 부여 (이때 다른 길이를 쓸 수 있는 list 를 써야한다.)
```

``` r
matrix(1:12,nrow=3,byrow=TRUE)
```

    ##      [,1] [,2] [,3] [,4]
    ## [1,]    1    2    3    4
    ## [2,]    5    6    7    8
    ## [3,]    9   10   11   12

``` r
# byrow : 가로로 먼저 채워지게 한다. default 는 세로(col)
```

``` r
mat <- matrix(1:12,nrow=3,
              byrow = TRUE,
              dimnames = list(c('a','b','c'),c('1','2','3','4'))) ; mat
```

    ##   1  2  3  4
    ## a 1  2  3  4
    ## b 5  6  7  8
    ## c 9 10 11 12

``` r
mat[6] # 그냥 6번째로 index 를 주게되면 col 부터 세게 되므로 10을 추출
```

    ## [1] 10

``` r
mat[2,3] # 2row, 3col 의 값
```

    ## [1] 7

``` r
mat['a','2'] # 이름으로도 추출 가능
```

    ## [1] 2

``` r
mat[1:3,1] # 범위를 추출 가능
```

    ## a b c 
    ## 1 5 9

``` r
mat[c(1,3),c(2,4)] # vector 를 이용해 추출 가능
```

    ##    2  4
    ## a  2  4
    ## c 10 12

``` r
mat['a',c(3,1)] # 이름과 같이 추출 가능
```

    ## 3 1 
    ## 3 1

## factor

factor(요인) : 범주형(명목/순서)의 데이터구조<br> 요인이 가질 수 있는값들을 수준(level) 이라고 한다.<br>
factor 는 레벨을 알파벳 순으로 정렬한다. <br> 그 다음 알파벳 순의 레벨의 정수 인덱스로 벡터 내용을 다시
만든다.<br> 펙터의 실제 내용은 레벨의 정수 인덱스이고, 각 정수를 레벨명으로 해독 가능한 범례가 있다고 생각하면
쉽다.<br>

``` r
data = c('c','a','b')
example = factor(data)
as.numeric(example) # 위를 보면 3,1,2 로 되어있음을 볼 수 있다.
```

    ## [1] 3 1 2

``` r
# 즉 알파벳 순으로 factor 를 지정해준것 
```

``` r
factor(data,levels=c('c','b','a'),ordered = T) 
```

    ## [1] c a b
    ## Levels: c < b < a

``` r
# 이렇게 하면 c,b,a 순으로 1,2,3 의 값을 매기고 ordered 가 c<b<a 로 된다.
# 즉 ordered data 를 만들고 싶을때 쓰게 된다.
```

\#\#Dataframe 데이터 유형에 상관없는 2차원데이터

``` r
name <- c('john','kim','marry')
age <- c(45,44,22)
child <- c(T,T,F)
df <- data.frame(name,age,child) ; df
```

    ##    name age child
    ## 1  john  45  TRUE
    ## 2   kim  44  TRUE
    ## 3 marry  22 FALSE

# 데이터 구조 변환

``` r
library(MASS)
str(Cars93)
```

    ## 'data.frame':    93 obs. of  27 variables:
    ##  $ Manufacturer      : Factor w/ 32 levels "Acura","Audi",..: 1 1 2 2 3 4 4 4 4 5 ...
    ##  $ Model             : Factor w/ 93 levels "100","190E","240",..: 49 56 9 1 6 24 54 74 73 35 ...
    ##  $ Type              : Factor w/ 6 levels "Compact","Large",..: 4 3 1 3 3 3 2 2 3 2 ...
    ##  $ Min.Price         : num  12.9 29.2 25.9 30.8 23.7 14.2 19.9 22.6 26.3 33 ...
    ##  $ Price             : num  15.9 33.9 29.1 37.7 30 15.7 20.8 23.7 26.3 34.7 ...
    ##  $ Max.Price         : num  18.8 38.7 32.3 44.6 36.2 17.3 21.7 24.9 26.3 36.3 ...
    ##  $ MPG.city          : int  25 18 20 19 22 22 19 16 19 16 ...
    ##  $ MPG.highway       : int  31 25 26 26 30 31 28 25 27 25 ...
    ##  $ AirBags           : Factor w/ 3 levels "Driver & Passenger",..: 3 1 2 1 2 2 2 2 2 2 ...
    ##  $ DriveTrain        : Factor w/ 3 levels "4WD","Front",..: 2 2 2 2 3 2 2 3 2 2 ...
    ##  $ Cylinders         : Factor w/ 6 levels "3","4","5","6",..: 2 4 4 4 2 2 4 4 4 5 ...
    ##  $ EngineSize        : num  1.8 3.2 2.8 2.8 3.5 2.2 3.8 5.7 3.8 4.9 ...
    ##  $ Horsepower        : int  140 200 172 172 208 110 170 180 170 200 ...
    ##  $ RPM               : int  6300 5500 5500 5500 5700 5200 4800 4000 4800 4100 ...
    ##  $ Rev.per.mile      : int  2890 2335 2280 2535 2545 2565 1570 1320 1690 1510 ...
    ##  $ Man.trans.avail   : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 1 1 1 1 1 ...
    ##  $ Fuel.tank.capacity: num  13.2 18 16.9 21.1 21.1 16.4 18 23 18.8 18 ...
    ##  $ Passengers        : int  5 5 5 6 4 6 6 6 5 6 ...
    ##  $ Length            : int  177 195 180 193 186 189 200 216 198 206 ...
    ##  $ Wheelbase         : int  102 115 102 106 109 105 111 116 108 114 ...
    ##  $ Width             : int  68 71 67 70 69 69 74 78 73 73 ...
    ##  $ Turn.circle       : int  37 38 37 37 39 41 42 45 41 43 ...
    ##  $ Rear.seat.room    : num  26.5 30 28 31 27 28 30.5 30.5 26.5 35 ...
    ##  $ Luggage.room      : int  11 15 14 17 13 16 17 21 14 18 ...
    ##  $ Weight            : int  2705 3560 3375 3405 3640 2880 3470 4105 3495 3620 ...
    ##  $ Origin            : Factor w/ 2 levels "USA","non-USA": 2 2 2 2 2 1 1 1 1 1 ...
    ##  $ Make              : Factor w/ 93 levels "Acura Integra",..: 1 2 4 3 5 6 7 9 8 10 ...

위와 같이 하나의 데이터에도 많은 데이터 형태가 있음을 볼 수 있다. <br> 데이터 형태를 잘 알아두어야 <br> 1.각 데이터
속성에 맞는 함수를 적용가능<br> 2.데이터별 속성이 잘못 들어간 경우 바로잡기 가능 (숫자형이 factor 라든지…)

``` r
# as.factor(데이터) : 데이터를 factor 로 변환해준다.
x <- c('A','B','C')
factor_x <- as.factor(x)
str(factor_x) # level이 생긴 factor 형태가 된 것을 볼 수 있다.
```

    ##  Factor w/ 3 levels "A","B","C": 1 2 3

``` r
# as.numeric(데이터) : 데이터를 숫자로 변환한다.
x <- c('4','5','10')
str(x) # chr 의 데이터 tpye
```

    ##  chr [1:3] "4" "5" "10"

``` r
numeric_x <- as.numeric(x)
str(numeric_x) # chr -> num 으로 데이터 type 이 바뀐것을 볼 수 있다.
```

    ##  num [1:3] 4 5 10

``` r
# as.character(데이터) : 데이터를 chr 로 변환
as.character(3.14)
```

    ## [1] "3.14"

``` r
# as.vector(데이터) : 데이터를 vector 로 변환
as.vector('C')
```

    ## [1] "C"

``` r
# as.logical(데이터) : logic 값으로 변환
as.logical(3.42) # 이때에 0 일때에만 False 를 내보내고 나머지 경우는 True 를 나타낸다. 
```

    ## [1] TRUE

``` r
as.integer(3.2)
```

    ## [1] 3

``` r
as.numeric('go') # 바꿀수 없는 경우 에러가 뜬다.
```

    ## Warning: 강제형변환에 의해 생성된 NA 입니다

    ## [1] NA

``` r
as.character(100)
```

    ## [1] "100"

``` r
as.numeric(FALSE) # FALSE 인 경우 0 
```

    ## [1] 0

``` r
# unlist(list) # 리스트를 다른형태로 바꾼다.
```

# Attribute

r 에서 Attribute 는 속성을 의미한다. <br> R 에서는 데이터에 들어있는 일종의 주석이라고 받아드리면 된다.
mtcars 데이터를 scaling 해보자.

``` r
car_scaled <- scale(mtcars) 
car_scaled
```

    ##                             mpg        cyl        disp          hp        drat
    ## Mazda RX4            0.15088482 -0.1049878 -0.57061982 -0.53509284  0.56751369
    ## Mazda RX4 Wag        0.15088482 -0.1049878 -0.57061982 -0.53509284  0.56751369
    ## Datsun 710           0.44954345 -1.2248578 -0.99018209 -0.78304046  0.47399959
    ## Hornet 4 Drive       0.21725341 -0.1049878  0.22009369 -0.53509284 -0.96611753
    ## Hornet Sportabout   -0.23073453  1.0148821  1.04308123  0.41294217 -0.83519779
    ## Valiant             -0.33028740 -0.1049878 -0.04616698 -0.60801861 -1.56460776
    ## Duster 360          -0.96078893  1.0148821  1.04308123  1.43390296 -0.72298087
    ## Merc 240D            0.71501778 -1.2248578 -0.67793094 -1.23518023  0.17475447
    ## Merc 230             0.44954345 -1.2248578 -0.72553512 -0.75387015  0.60491932
    ## Merc 280            -0.14777380 -0.1049878 -0.50929918 -0.34548584  0.60491932
    ## Merc 280C           -0.38006384 -0.1049878 -0.50929918 -0.34548584  0.60491932
    ## Merc 450SE          -0.61235388  1.0148821  0.36371309  0.48586794 -0.98482035
    ## Merc 450SL          -0.46302456  1.0148821  0.36371309  0.48586794 -0.98482035
    ## Merc 450SLC         -0.81145962  1.0148821  0.36371309  0.48586794 -0.98482035
    ## Cadillac Fleetwood  -1.60788262  1.0148821  1.94675381  0.85049680 -1.24665983
    ## Lincoln Continental -1.60788262  1.0148821  1.84993175  0.99634834 -1.11574009
    ## Chrysler Imperial   -0.89442035  1.0148821  1.68856165  1.21512565 -0.68557523
    ## Fiat 128             2.04238943 -1.2248578 -1.22658929 -1.17683962  0.90416444
    ## Honda Civic          1.71054652 -1.2248578 -1.25079481 -1.38103178  2.49390411
    ## Toyota Corolla       2.29127162 -1.2248578 -1.28790993 -1.19142477  1.16600392
    ## Toyota Corona        0.23384555 -1.2248578 -0.89255318 -0.72469984  0.19345729
    ## Dodge Challenger    -0.76168319  1.0148821  0.70420401  0.04831332 -1.56460776
    ## AMC Javelin         -0.81145962  1.0148821  0.59124494  0.04831332 -0.83519779
    ## Camaro Z28          -1.12671039  1.0148821  0.96239618  1.43390296  0.24956575
    ## Pontiac Firebird    -0.14777380  1.0148821  1.36582144  0.41294217 -0.96611753
    ## Fiat X1-9            1.19619000 -1.2248578 -1.22416874 -1.17683962  0.90416444
    ## Porsche 914-2        0.98049211 -1.2248578 -0.89093948 -0.81221077  1.55876313
    ## Lotus Europa         1.71054652 -1.2248578 -1.09426581 -0.49133738  0.32437703
    ## Ford Pantera L      -0.71190675  1.0148821  0.97046468  1.71102089  1.16600392
    ## Ferrari Dino        -0.06481307 -0.1049878 -0.69164740  0.41294217  0.04383473
    ## Maserati Bora       -0.84464392  1.0148821  0.56703942  2.74656682 -0.10578782
    ## Volvo 142E           0.21725341 -1.2248578 -0.88529152 -0.54967799  0.96027290
    ##                               wt        qsec         vs         am       gear
    ## Mazda RX4           -0.610399567 -0.77716515 -0.8680278  1.1899014  0.4235542
    ## Mazda RX4 Wag       -0.349785269 -0.46378082 -0.8680278  1.1899014  0.4235542
    ## Datsun 710          -0.917004624  0.42600682  1.1160357  1.1899014  0.4235542
    ## Hornet 4 Drive      -0.002299538  0.89048716  1.1160357 -0.8141431 -0.9318192
    ## Hornet Sportabout    0.227654255 -0.46378082 -0.8680278 -0.8141431 -0.9318192
    ## Valiant              0.248094592  1.32698675  1.1160357 -0.8141431 -0.9318192
    ## Duster 360           0.360516446 -1.12412636 -0.8680278 -0.8141431 -0.9318192
    ## Merc 240D           -0.027849959  1.20387148  1.1160357 -0.8141431  0.4235542
    ## Merc 230            -0.068730634  2.82675459  1.1160357 -0.8141431  0.4235542
    ## Merc 280             0.227654255  0.25252621  1.1160357 -0.8141431  0.4235542
    ## Merc 280C            0.227654255  0.58829513  1.1160357 -0.8141431  0.4235542
    ## Merc 450SE           0.871524874 -0.25112717 -0.8680278 -0.8141431 -0.9318192
    ## Merc 450SL           0.524039143 -0.13920420 -0.8680278 -0.8141431 -0.9318192
    ## Merc 450SLC          0.575139986  0.08464175 -0.8680278 -0.8141431 -0.9318192
    ## Cadillac Fleetwood   2.077504765  0.07344945 -0.8680278 -0.8141431 -0.9318192
    ## Lincoln Continental  2.255335698 -0.01608893 -0.8680278 -0.8141431 -0.9318192
    ## Chrysler Imperial    2.174596366 -0.23993487 -0.8680278 -0.8141431 -0.9318192
    ## Fiat 128            -1.039646647  0.90727560  1.1160357  1.1899014  0.4235542
    ## Honda Civic         -1.637526508  0.37564148  1.1160357  1.1899014  0.4235542
    ## Toyota Corolla      -1.412682800  1.14790999  1.1160357  1.1899014  0.4235542
    ## Toyota Corona       -0.768812180  1.20946763  1.1160357 -0.8141431 -0.9318192
    ## Dodge Challenger     0.309415603 -0.54772305 -0.8680278 -0.8141431 -0.9318192
    ## AMC Javelin          0.222544170 -0.30708866 -0.8680278 -0.8141431 -0.9318192
    ## Camaro Z28           0.636460997 -1.36476075 -0.8680278 -0.8141431 -0.9318192
    ## Pontiac Firebird     0.641571082 -0.44699237 -0.8680278 -0.8141431 -0.9318192
    ## Fiat X1-9           -1.310481114  0.58829513  1.1160357  1.1899014  0.4235542
    ## Porsche 914-2       -1.100967659 -0.64285758 -0.8680278  1.1899014  1.7789276
    ## Lotus Europa        -1.741772228 -0.53093460  1.1160357  1.1899014  1.7789276
    ## Ford Pantera L      -0.048290296 -1.87401028 -0.8680278  1.1899014  1.7789276
    ## Ferrari Dino        -0.457097039 -1.31439542 -0.8680278  1.1899014  1.7789276
    ## Maserati Bora        0.360516446 -1.81804880 -0.8680278  1.1899014  1.7789276
    ## Volvo 142E          -0.446876870  0.42041067  1.1160357  1.1899014  0.4235542
    ##                           carb
    ## Mazda RX4            0.7352031
    ## Mazda RX4 Wag        0.7352031
    ## Datsun 710          -1.1221521
    ## Hornet 4 Drive      -1.1221521
    ## Hornet Sportabout   -0.5030337
    ## Valiant             -1.1221521
    ## Duster 360           0.7352031
    ## Merc 240D           -0.5030337
    ## Merc 230            -0.5030337
    ## Merc 280             0.7352031
    ## Merc 280C            0.7352031
    ## Merc 450SE           0.1160847
    ## Merc 450SL           0.1160847
    ## Merc 450SLC          0.1160847
    ## Cadillac Fleetwood   0.7352031
    ## Lincoln Continental  0.7352031
    ## Chrysler Imperial    0.7352031
    ## Fiat 128            -1.1221521
    ## Honda Civic         -0.5030337
    ## Toyota Corolla      -1.1221521
    ## Toyota Corona       -1.1221521
    ## Dodge Challenger    -0.5030337
    ## AMC Javelin         -0.5030337
    ## Camaro Z28           0.7352031
    ## Pontiac Firebird    -0.5030337
    ## Fiat X1-9           -1.1221521
    ## Porsche 914-2       -0.5030337
    ## Lotus Europa        -0.5030337
    ## Ford Pantera L       0.7352031
    ## Ferrari Dino         1.9734398
    ## Maserati Bora        3.2116766
    ## Volvo 142E          -0.5030337
    ## attr(,"scaled:center")
    ##        mpg        cyl       disp         hp       drat         wt       qsec 
    ##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
    ##         vs         am       gear       carb 
    ##   0.437500   0.406250   3.687500   2.812500 
    ## attr(,"scaled:scale")
    ##         mpg         cyl        disp          hp        drat          wt 
    ##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
    ##        qsec          vs          am        gear        carb 
    ##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000

attr 가 있는것을 볼 수 있다. 이 attr 를 꺼내고 싶다면

``` r
attributes(car_scaled)$`scaled:center`
```

    ##        mpg        cyl       disp         hp       drat         wt       qsec 
    ##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
    ##         vs         am       gear       carb 
    ##   0.437500   0.406250   3.687500   2.812500

각각의 표준화 때에 사용했던 scale 들을 받을 수 있게 되었다.

아래와 같은 방식으로도 가능

``` r
attr(car_scaled,"scaled:center") 
```

    ##        mpg        cyl       disp         hp       drat         wt       qsec 
    ##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
    ##         vs         am       gear       carb 
    ##   0.437500   0.406250   3.687500   2.812500

아래와 같은 방식으로 attr 를 할당할 수 도 있다.

``` r
x <- c(1:10)
attr(x,'data') <- '20210105'
x
```

    ##  [1]  1  2  3  4  5  6  7  8  9 10
    ## attr(,"data")
    ## [1] "20210105"
